<div class="flex items-center relative">
  <%= link_to trip_path(@trip), class:"absolute flex items-center bg-panel-navy rounded-md shadow-secondary h-6 w-10 py-0.5 px-0.5 ml-4" do %>
    <%= inline_svg("svg/navigation-arrow.svg", class:"w-full h-full rotate-180 text-white")%>
  <% end %>
  <h1 class="mt-2 my-2 text-xl font-bold w-full text-center">精算結果</h1>
</div>

<%= render 'trip_card', trip: @trip, mode: :result %>


<section class="flex-1 overflow-y-auto">
  <% @settlements.each do |s| %>
    <div class="card-style mt-4 py-3 px-4 flex items-center">
      <div class="w-full flex justify-between">
        <div class="w-1/3 text-lg font-bold"><%= s[:from].name %></div>


        <div class="w-5/7 flex flex-col">
          <% s[:payments].each_with_index do |p, i| %>
            <div class="flex items-center justify-between">
              <div class="flex items-center">
                <%= inline_svg("svg/long-arrow.svg", class:"w-6 text-black rotate-180 mx-2") %>
                <div class="text-lg font-bold"><%= p[:to].name %></div>
              </div>
              <div class="text-lg font-bold ml-2">¥<%= number_with_delimiter(p[:amount]) %></div>
            </div>
            <% unless i + 1 == s[:payments].size %>
              <div class="h-0.5 bg-gray-200 w-full my-1.5"></div>
            <% end %>
          <% end %>
        </div>
      </div>
    </div>
  <% end %>
</section> 


<div class="mx-4 my-3">
  <div class="h-1 bg-panel-navy"></div>
<section class="w-full flex">
  <%= link_to trip_path(@trip), class:"w-3/10" do %>
    <div class=" mt-2 rounded-md bg-gray-400 py-2 shadow-primary">
      <p class="text-white text-2xl text-center font-bold">戻る</p>
    </div>
  <% end %>

  <% if @trip.unsettled? %>

    <%= form_with url: settle_trip_path(@trip), method: :patch, data:{confirm: "旅行を精算済みにしますか？"}, class:"w-full ml-4" do %>
      <button type="submit" class="mt-2 rounded-md bg-primary-blue-100 py-2 shadow-primary w-full text-2xl flex items-center justify-center">
        <span class="text-white text-center font-bold">精算済みにする</span>
        <%= inline_svg("svg/settle.svg", class:"w-[28px] ml-2 text-white") %>
      </button>
    <% end %>

  <% elsif @trip.settled? %>

      <%= form_with url: unsettle_trip_path(@trip), method: :patch, data:{confirm: "旅行を未精算に変更しますか？"}, class:"w-full ml-4" do %>
      <button type="submit" class="mt-2 rounded-md bg-primary-red py-2 shadow-primary w-full text-2xl flex items-center justify-center">
        <span class="text-white text-center font-bold">未精算にする</span>
        <%= inline_svg("svg/reset.svg", class:"w-[34px] ml-2 text-white") %>
        </button>
    <% end %>

  <% end %>

</section>




</div>





